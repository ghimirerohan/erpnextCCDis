{"version":3,"file":"Home-C6F9gUkg.js","sources":["../../../../frontend/src/pages/Home.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen bg-gray-50\">\n    <!-- Header -->\n    <div class=\"bg-white shadow-sm border-b border-gray-200\">\n      <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div class=\"flex justify-between items-center py-6\">\n          <div>\n            <h1 class=\"text-2xl font-bold text-gray-900\">Sales Invoice Dashboard</h1>\n            <p class=\"text-sm text-gray-600\">Welcome {{ session.user }}!</p>\n          </div>\n          <div class=\"flex gap-2\">\n          <Button @click=\"$router.push({ name: 'Scanner' })\" theme=\"blue\" variant=\"solid\">\n            Open Scanner\n          </Button>\n          <Button @click=\"session.logout.submit()\" theme=\"gray\" variant=\"outline\">\n            Logout\n          </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Main Content -->\n    <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n      <!-- Filters Section -->\n      <div class=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8\">\n        <h2 class=\"text-lg font-semibold text-gray-900 mb-4\">Filters</h2>\n        <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div class=\"relative\">\n            <label class=\"block text-sm font-medium text-gray-700 mb-2\">Customer</label>\n            <div class=\"relative\">\n              <div v-if=\"selectionLocked\" class=\"border border-gray-300 rounded-md p-3\">\n                <div class=\"text-sm font-medium text-gray-900\">{{ selectedCustomer.customer_name }}</div>\n                <div class=\"text-xs text-gray-600 mt-1\">\n                  <span>Code: {{ selectedCustomer.customer_code || '—' }}</span>\n                  <span class=\"mx-2\">|</span>\n                  <span>Invoice: {{ selectedCustomer.invoice_no || '—' }}</span>\n                </div>\n                <div class=\"mt-2\">\n                  <button @click=\"resetSelection\" class=\"text-sm text-blue-600 underline\">Change selection</button>\n                </div>\n              </div>\n              <div v-else>\n                <div class=\"flex flex-wrap gap-2 mb-3\">\n                  <button\n                    @click=\"selectMode = 'list'\"\n                    :class=\"[\n                      'flex-1 min-w-[120px] px-3 py-2 text-sm font-medium rounded-md border transition-colors',\n                      selectMode === 'list' ? 'bg-blue-50 border-blue-400 text-blue-700' : 'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'\n                    ]\"\n                  >\n                    Customer List\n                  </button>\n                  <button\n                    @click=\"selectMode = 'qr'\"\n                    :class=\"[\n                      'flex-1 min-w-[120px] px-3 py-2 text-sm font-medium rounded-md border transition-colors',\n                      selectMode === 'qr' ? 'bg-blue-50 border-blue-400 text-blue-700' : 'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'\n                    ]\"\n                  >\n                    QR Scanner\n                  </button>\n                  <button\n                    @click=\"selectMode = 'photo'\"\n                    :class=\"[\n                      'flex-1 min-w-[120px] px-3 py-2 text-sm font-medium rounded-md border transition-colors',\n                      selectMode === 'photo' ? 'bg-blue-50 border-blue-400 text-blue-700' : 'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'\n                    ]\"\n                  >\n                    Photo / Camera\n                  </button>\n                </div>\n                <div v-if=\"selectMode === 'qr'\" class=\"p-3 border border-gray-200 rounded-md text-sm text-gray-700\">\n                  <div v-if=\"qrSupported\">\n                    <div class=\"mb-2\">Point your camera at the QR code.</div>\n                    <video ref=\"qrVideo\" class=\"w-full rounded\" autoplay playsinline muted></video>\n                    <div class=\"mt-2 text-xs text-gray-500\">Scanning...</div>\n                  </div>\n                  <div v-else>\n                    QR scanning is not supported on this device/browser. Please use Photo.\n                  </div>\n                </div>\n                <div v-else-if=\"selectMode === 'photo'\" class=\"p-3 border border-gray-200 rounded-md\">\n                  <input type=\"file\" accept=\"image/*\" capture=\"environment\" @change=\"onPhotoSelected\" />\n                  <div v-if=\"extractLoading\" class=\"mt-2 text-sm text-gray-600\">Processing image...</div>\n                  <Alert v-if=\"extractError\" theme=\"red\" class=\"mt-2\">{{ extractError }}</Alert>\n                </div>\n                <div v-else-if=\"selectMode === 'list'\" class=\"p-3 border border-gray-200 rounded-md\">\n                  <Autocomplete\n                    v-model=\"selectedCustomerLabel\"\n                    :options=\"customerOptions\"\n                    :loading=\"customerListLoading\"\n                    :debounce=\"300\"\n                    placeholder=\"Search by customer name or code...\"\n                    @update:query=\"handleCustomerQuery\"\n                    @select=\"onCustomerSelected\"\n                    :clearable=\"true\"\n                  />\n                  <p v-if=\"!filters.customer\" class=\"mt-2 text-sm text-gray-500\">Start typing to search for a customer</p>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700 mb-2\">From Date</label>\n            <input \n              type=\"date\" \n              v-model=\"filters.from_date\"\n              class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              required\n            />\n          </div>\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700 mb-2\">To Date</label>\n            <input \n              type=\"date\" \n              v-model=\"filters.to_date\"\n              class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              required\n            />\n          </div>\n        </div>\n        <div class=\"mt-4 flex justify-end\">\n          <Button \n            @click=\"loadData\" \n            :loading=\"loading\" \n            theme=\"blue\" \n            variant=\"solid\"\n            :disabled=\"!filters.customer || !filters.from_date || !filters.to_date\"\n          >\n            Load Data\n          </Button>\n        </div>\n      </div>\n\n      <!-- View Toggle -->\n      <div class=\"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6\">\n        <div class=\"flex items-center justify-between\">\n          <h2 class=\"text-lg font-semibold text-gray-900\">View Options</h2>\n          <div class=\"flex bg-gray-100 rounded-lg p-1\">\n            <button\n              @click=\"viewMode = 'bill'\"\n              :class=\"[\n                'px-4 py-2 text-sm font-medium rounded-md transition-colors',\n                viewMode === 'bill' \n                  ? 'bg-white text-blue-600 shadow-sm' \n                  : 'text-gray-600 hover:text-gray-900'\n              ]\"\n            >\n              Bill-wise View\n            </button>\n            <button\n              @click=\"viewMode = 'summary'\"\n              :class=\"[\n                'px-4 py-2 text-sm font-medium rounded-md transition-colors',\n                viewMode === 'summary' \n                  ? 'bg-white text-blue-600 shadow-sm' \n                  : 'text-gray-600 hover:text-gray-900'\n              ]\"\n            >\n              Summary View\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <!-- Loading State -->\n      <div v-if=\"loading\" class=\"flex justify-center items-center py-12\">\n        <div class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        <span class=\"ml-3 text-gray-600\">Loading data...</span>\n      </div>\n\n      <!-- Error State -->\n      <Alert v-if=\"error\" theme=\"red\" class=\"mb-6\">\n        {{ error }}\n      </Alert>\n\n      <!-- Bill-wise View -->\n      <div v-if=\"viewMode === 'bill' && !loading && data.length > 0\" class=\"space-y-6\">\n        <div class=\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden\">\n          <div class=\"px-6 py-4 border-b border-gray-200\">\n            <h3 class=\"text-lg font-semibold text-gray-900\">\n              Sales Invoices ({{ data.length }} invoices)\n            </h3>\n          </div>\n          <div class=\"overflow-x-auto\">\n            <table class=\"min-w-full divide-y divide-gray-200\">\n              <thead class=\"bg-gray-50\">\n                <tr>\n                  <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Invoice\n                  </th>\n                  <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Date\n                  </th>\n                  <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Customer\n                  </th>\n                  <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Status\n                  </th>\n                  <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Total Amount\n                  </th>\n                  <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Outstanding\n                  </th>\n                </tr>\n              </thead>\n              <tbody class=\"bg-white divide-y divide-gray-200\">\n                <tr v-for=\"invoice in data\" :key=\"invoice.name\" class=\"hover:bg-gray-50\">\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600\">\n                    {{ invoice.name }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {{ formatDate(invoice.posting_date) }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {{ invoice.customer_name }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap\">\n                    <Badge :theme=\"getStatusTheme(invoice.status)\">\n                      {{ invoice.status }}\n                    </Badge>\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 font-medium\">\n                    {{ formatCurrency(invoice.grand_total) }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900\">\n                    {{ formatCurrency(invoice.outstanding_amount) }}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <!-- Invoice Details -->\n        <div v-for=\"invoice in data\" :key=\"`details-${invoice.name}`\" class=\"bg-white rounded-lg shadow-sm border border-gray-200\">\n          <div class=\"px-6 py-4 border-b border-gray-200\">\n            <h4 class=\"text-md font-semibold text-gray-900\">\n              Invoice: {{ invoice.name }} - {{ invoice.customer_name }}\n            </h4>\n            <p class=\"text-sm text-gray-600\">\n              Date: {{ formatDate(invoice.posting_date) }} | \n              Total: {{ formatCurrency(invoice.grand_total) }}\n            </p>\n          </div>\n          <div class=\"overflow-x-auto\">\n            <table class=\"min-w-full divide-y divide-gray-200\">\n              <thead class=\"bg-gray-50\">\n                <tr>\n                  <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Item\n                  </th>\n                  <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Description\n                  </th>\n                  <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Qty\n                  </th>\n                  <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Rate\n                  </th>\n                  <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Amount\n                  </th>\n                </tr>\n              </thead>\n              <tbody class=\"bg-white divide-y divide-gray-200\">\n                <tr v-for=\"item in invoice.items\" :key=\"item.item_code\" class=\"hover:bg-gray-50\">\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                    {{ item.item_code }}\n                  </td>\n                  <td class=\"px-6 py-4 text-sm text-gray-900\">\n                    {{ item.item_name }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900\">\n                    {{ item.qty }} {{ item.uom }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900\">\n                    {{ formatCurrency(item.rate) }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 font-medium\">\n                    {{ formatCurrency(item.amount) }}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n\n      <!-- Summary View -->\n      <div v-if=\"viewMode === 'summary' && !loading && summaryData.length > 0\" class=\"space-y-6\">\n        <div class=\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden\">\n          <div class=\"px-6 py-4 border-b border-gray-200\">\n            <h3 class=\"text-lg font-semibold text-gray-900\">\n              Summary by Customer & Date ({{ summaryData.length }} groups)\n            </h3>\n          </div>\n          <div class=\"overflow-x-auto\">\n            <table class=\"min-w-full divide-y divide-gray-200\">\n              <thead class=\"bg-gray-50\">\n                <tr>\n                  <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Customer\n                  </th>\n                  <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Date\n                  </th>\n                  <th class=\"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Invoices\n                  </th>\n                  <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Total Amount\n                  </th>\n                  <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Net Total\n                  </th>\n                  <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Outstanding\n                  </th>\n                </tr>\n              </thead>\n              <tbody class=\"bg-white divide-y divide-gray-200\">\n                <tr v-for=\"group in summaryData\" :key=\"`${group.customer}-${group.posting_date}`\" class=\"hover:bg-gray-50\">\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                    {{ group.customer_name }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {{ formatDate(group.posting_date) }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-center text-gray-900\">\n                    {{ group.invoice_count }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 font-medium\">\n                    {{ formatCurrency(group.total_amount) }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900\">\n                    {{ formatCurrency(group.net_total) }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900\">\n                    {{ formatCurrency(group.outstanding_amount) }}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <!-- Item Summary -->\n        <div v-for=\"group in summaryData\" :key=\"`summary-${group.customer}-${group.posting_date}`\" class=\"bg-white rounded-lg shadow-sm border border-gray-200\">\n          <div class=\"px-6 py-4 border-b border-gray-200\">\n            <h4 class=\"text-md font-semibold text-gray-900\">\n              {{ group.customer_name }} - {{ formatDate(group.posting_date) }}\n            </h4>\n            <p class=\"text-sm text-gray-600\">\n              {{ group.invoice_count }} invoices | \n              Total: {{ formatCurrency(group.total_amount) }}\n            </p>\n          </div>\n          <div class=\"overflow-x-auto\">\n            <table class=\"min-w-full divide-y divide-gray-200\">\n              <thead class=\"bg-gray-50\">\n                <tr>\n                  <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Item\n                  </th>\n                  <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Description\n                  </th>\n                  <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Total Qty\n                  </th>\n                  <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Avg Rate\n                  </th>\n                  <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Total Amount\n                  </th>\n                </tr>\n              </thead>\n              <tbody class=\"bg-white divide-y divide-gray-200\">\n                <tr v-for=\"item in group.items\" :key=\"item.item_code\" class=\"hover:bg-gray-50\">\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                    {{ item.item_code }}\n                  </td>\n                  <td class=\"px-6 py-4 text-sm text-gray-900\">\n                    {{ item.item_name }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900\">\n                    {{ item.total_qty }} {{ item.uom }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900\">\n                    {{ formatCurrency(item.avg_rate) }}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 font-medium\">\n                    {{ formatCurrency(item.total_amount) }}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n\n      <!-- Empty State -->\n      <div v-if=\"!loading && data.length === 0 && summaryData.length === 0\" class=\"text-center py-12\">\n        <div class=\"text-gray-400 mb-4\">\n          <svg class=\"mx-auto h-12 w-12\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n          </svg>\n        </div>\n        <h3 class=\"text-lg font-medium text-gray-900 mb-2\">No data found</h3>\n        <p class=\"text-gray-600\">Try adjusting your filters or selecting a different date range.</p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted, watch, computed } from \"vue\"\nimport { createResource, Autocomplete } from \"frappe-ui\"\nimport { session } from \"../data/session\"\n\n// Reactive data\nconst loading = ref(false)\nconst error = ref(\"\")\nconst viewMode = ref(\"bill\")\nconst data = ref([])\nconst summaryData = ref([])\n\nconst filters = reactive({\n  customer: \"\",\n  from_date: \"\",\n  to_date: \"\"\n})\n\n// New customer selection flow state\nconst selectionLocked = ref(false)\nconst selectMode = ref('list')\nconst extractLoading = ref(false)\nconst extractError = ref(\"\")\nconst selectedCustomer = ref({ customer: \"\", customer_name: \"\", customer_code: \"\", invoice_no: \"\" })\nconst qrSupported = typeof window !== 'undefined' && 'BarcodeDetector' in window\nconst qrVideo = ref(null)\n\n// Customer list selection state\nconst selectedCustomerLabel = ref(\"\")\nconst customerListLoading = ref(false)\nconst customerList = ref([])\n\n// Computed options for autocomplete\nconst customerOptions = computed(() => {\n  return customerList.value.map(c => ({\n    label: c.customer_name || c.name,\n    value: c.name,\n    description: c.name\n  }))\n})\n\nconst salesInvoicesResource = createResource({\n  url: \"custom_erp.custom_erp.sales_invoice.api.get_sales_invoices\",\n  auto: false,\n  onSuccess: (result) => {\n    if (result.success) {\n      data.value = result.data\n      error.value = \"\"\n    } else {\n      error.value = result.error || \"Failed to load sales invoices\"\n    }\n  },\n  onError: (err) => {\n    error.value = \"Failed to load sales invoices: \" + err.message\n  }\n})\n\nconst salesInvoiceSummaryResource = createResource({\n  url: \"custom_erp.custom_erp.sales_invoice.api.get_sales_invoice_summary\",\n  auto: false,\n  onSuccess: (result) => {\n    if (result.success) {\n      summaryData.value = result.data\n      error.value = \"\"\n    } else {\n      error.value = result.error || \"Failed to load summary data\"\n    }\n  },\n  onError: (err) => {\n    error.value = \"Failed to load summary data: \" + err.message\n  }\n})\n\n// Methods\nconst loadData = async () => {\n  if (!filters.customer || !filters.from_date || !filters.to_date) {\n    error.value = \"Please fill in all required fields\"\n    return\n  }\n\n  loading.value = true\n  error.value = \"\"\n\n  try {\n    const filtersParam = JSON.stringify(filters)\n    \n    if (viewMode.value === \"bill\") {\n      await salesInvoicesResource.fetch({ filters: filtersParam })\n    } else {\n      await salesInvoiceSummaryResource.fetch({ filters: filtersParam })\n    }\n  } catch (err) {\n    error.value = \"Failed to load data: \" + err.message\n  } finally {\n    loading.value = false\n  }\n}\n\nconst formatDate = (dateString) => {\n  if (!dateString) return \"\"\n  const date = new Date(dateString)\n  return date.toLocaleDateString()\n}\n\nconst formatCurrency = (amount) => {\n  if (amount === null || amount === undefined) return \"0.00\"\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD'\n  }).format(amount)\n}\n\nconst getStatusTheme = (status) => {\n  const themes = {\n    'Paid': 'green',\n    'Unpaid': 'red',\n    'Overdue': 'orange',\n    'Draft': 'gray',\n    'Submitted': 'blue'\n  }\n  return themes[status] || 'gray'\n}\n\n// New customer extraction + resolution methods\nconst resetSelection = () => {\n  selectionLocked.value = false\n  filters.customer = \"\"\n  selectedCustomer.value = { customer: \"\", customer_name: \"\", customer_code: \"\", invoice_no: \"\" }\n  selectedCustomerLabel.value = \"\"\n  extractError.value = \"\"\n  customerList.value = []\n}\n\nconst onPhotoSelected = async (event) => {\n  const file = event?.target?.files?.[0]\n  if (!file) return\n  extractError.value = \"\"\n  extractLoading.value = true\n  try {\n    // Convert to base64 data URL and call Frappe server-side extractor\n    const b64 = await new Promise((resolve, reject) => {\n      const reader = new FileReader()\n      reader.onload = () => resolve(String(reader.result))\n      reader.onerror = reject\n      reader.readAsDataURL(file)\n    })\n    const res = await fetch('/api/method/custom_erp.custom_erp.purchase_invoice.api.extract_invoice', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ image_data: b64 })\n    })\n    const json = await res.json()\n    const msg = json?.message || json\n    if (!res.ok || !msg?.success || !msg?.data) {\n      throw new Error(msg?.error || `Extraction failed (${res.status})`)\n    }\n\n    const invoiceBillNumber = msg.data.invoiceNumber || ''\n    const customerName = msg.data.customerName || ''\n    // Minimal resolver: try invoice number first; customerCode not available from full extractor\n    const resolved = await resolveCustomer({ invoiceBillNumber, customerCode: '' })\n    if (!resolved) {\n      throw new Error('Could not find matching customer from code or invoice')\n    }\n    filters.customer = resolved.customer\n    selectedCustomer.value = {\n      customer: resolved.customer,\n      customer_name: resolved.customer_name || customerName || resolved.customer,\n      customer_code: '',\n      invoice_no: invoiceBillNumber || ''\n    }\n    selectionLocked.value = true\n  } catch (e) {\n    extractError.value = e.message || 'Failed to process image'\n  } finally {\n    extractLoading.value = false\n  }\n}\n\nasync function resolveCustomer({ invoiceBillNumber, customerCode }) {\n  // Priority 1: by customerCode\n  if (customerCode) {\n    // Try common fields one by one to avoid server errors on unknown fields\n    const fieldsToTry = ['mobile_no', 'customer_code']\n    for (const field of fieldsToTry) {\n      try {\n        const byCode = await findCustomerByField(field, customerCode)\n        if (byCode) return byCode\n      } catch (_) {\n        // ignore and try next\n      }\n    }\n  }\n  // Fallback: use invoice number to read Sales Invoice and derive customer\n  if (invoiceBillNumber) {\n    try {\n      const invRes = await fetch(`/api/resource/Sales%20Invoice/${encodeURIComponent(invoiceBillNumber)}`)\n      if (invRes.ok) {\n        const invJson = await invRes.json()\n        const doc = invJson?.data\n        if (doc?.customer) {\n          return { customer: doc.customer, customer_name: doc.customer_name || doc.customer }\n        }\n      }\n    } catch (_) {}\n  }\n  return null\n}\n\nasync function findCustomerByField(field, value) {\n  const params = new URLSearchParams()\n  params.set('fields', JSON.stringify(['name', 'customer_name']))\n  params.set('filters', JSON.stringify([[field, '=', String(value)]]))\n  params.set('limit_page_length', '1')\n  const res = await fetch(`/api/resource/Customer?${params.toString()}`)\n  if (!res.ok) return null\n  const json = await res.json()\n  const list = json?.data\n  if (Array.isArray(list) && list.length > 0) {\n    return { customer: list[0].name, customer_name: list[0].customer_name || list[0].name }\n  }\n  return null\n}\n\n// Customer list query handler\nconst handleCustomerQuery = async (query) => {\n  if (!query || query.length < 2) {\n    customerList.value = []\n    return\n  }\n  \n  customerListLoading.value = true\n  try {\n    const params = new URLSearchParams()\n    params.set('fields', JSON.stringify(['name', 'customer_name', 'customer_code', 'mobile_no']))\n    params.set('filters', JSON.stringify([]))\n    params.set('or_filters', JSON.stringify([\n      ['customer_name', 'like', `%${query}%`],\n      ['name', 'like', `%${query}%`],\n      ['customer_code', 'like', `%${query}%`],\n      ['mobile_no', 'like', `%${query}%`]\n    ]))\n    params.set('limit_page_length', '20')\n    \n    const res = await fetch(`/api/resource/Customer?${params.toString()}`)\n    if (res.ok) {\n      const json = await res.json()\n      customerList.value = json?.data || []\n    }\n  } catch (e) {\n    console.error('Failed to fetch customers:', e)\n    customerList.value = []\n  } finally {\n    customerListLoading.value = false\n  }\n}\n\n// Customer list selection handler\nconst onCustomerSelected = async (option) => {\n  if (!option || !option.value) return\n  \n  try {\n    // Fetch full customer details\n    const res = await fetch(`/api/resource/Customer/${encodeURIComponent(option.value)}`)\n    if (!res.ok) throw new Error('Failed to fetch customer details')\n    \n    const json = await res.json()\n    const customer = json?.data\n    \n    if (customer) {\n      filters.customer = customer.name\n      selectedCustomer.value = {\n        customer: customer.name,\n        customer_name: customer.customer_name || customer.name,\n        customer_code: customer.customer_code || customer.mobile_no || '',\n        invoice_no: ''\n      }\n      selectedCustomerLabel.value = customer.customer_name || customer.name\n      selectionLocked.value = true\n    }\n  } catch (e) {\n    error.value = 'Failed to load customer details: ' + (e.message || 'Unknown error')\n  }\n}\n\n// Watch for view mode changes\nwatch(viewMode, () => {\n  if (filters.customer && filters.from_date && filters.to_date) {\n    loadData()\n  }\n})\n\n// Initialize\nonMounted(() => {\n  // Set default dates (last 30 days)\n  const today = new Date()\n  const thirtyDaysAgo = new Date(today.getTime() - (30 * 24 * 60 * 60 * 1000))\n  \n  filters.to_date = today.toISOString().split('T')[0]\n  filters.from_date = thirtyDaysAgo.toISOString().split('T')[0]\n})\n</script>\n\n<style scoped>\n/* Custom styles for better responsiveness */\n@media (max-width: 768px) {\n  .grid-cols-1.md\\:grid-cols-3 {\n    grid-template-columns: repeat(1, minmax(0, 1fr));\n  }\n}\n\n/* Smooth transitions */\n.transition-colors {\n  transition: all 0.2s ease-in-out;\n}\n\n/* Hover effects */\n.hover\\:bg-gray-50:hover {\n  background-color: #f9fafb;\n}\n\n/* Custom scrollbar for tables */\n.overflow-x-auto::-webkit-scrollbar {\n  height: 6px;\n}\n\n.overflow-x-auto::-webkit-scrollbar-track {\n  background: #f1f1f1;\n  border-radius: 3px;\n}\n\n.overflow-x-auto::-webkit-scrollbar-thumb {\n  background: #c1c1c1;\n  border-radius: 3px;\n}\n\n.overflow-x-auto::-webkit-scrollbar-thumb:hover {\n  background: #a8a8a8;\n}\n</style>\n"],"names":["_openBlock","_createElementBlock","_createElementVNode","_unref","_createVNode","$router","_toDisplayString","_normalizeClass","_createBlock","Autocomplete","_vModelText","_Fragment","_renderList","_createTextVNode"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2aA,UAAM,UAAU,IAAI,KAAK;AACzB,UAAM,QAAQ,IAAI,EAAE;AACpB,UAAM,WAAW,IAAI,MAAM;AAC3B,UAAM,OAAO,IAAI,CAAE,CAAA;AACnB,UAAM,cAAc,IAAI,CAAE,CAAA;AAE1B,UAAM,UAAU,SAAS;AAAA,MACvB,UAAU;AAAA,MACV,WAAW;AAAA,MACX,SAAS;AAAA,IACX,CAAC;AAGD,UAAM,kBAAkB,IAAI,KAAK;AACjC,UAAM,aAAa,IAAI,MAAM;AAC7B,UAAM,iBAAiB,IAAI,KAAK;AAChC,UAAM,eAAe,IAAI,EAAE;AAC3B,UAAM,mBAAmB,IAAI,EAAE,UAAU,IAAI,eAAe,IAAI,eAAe,IAAI,YAAY,GAAI,CAAA;AACnG,UAAM,cAAc,OAAO,WAAW,eAAe,qBAAqB;AAC1E,UAAM,UAAU,IAAI,IAAI;AAGxB,UAAM,wBAAwB,IAAI,EAAE;AACpC,UAAM,sBAAsB,IAAI,KAAK;AACrC,UAAM,eAAe,IAAI,CAAE,CAAA;AAG3B,UAAM,kBAAkB,SAAS,MAAM;AACrC,aAAO,aAAa,MAAM,IAAI,QAAM;AAAA,QAClC,OAAO,EAAE,iBAAiB,EAAE;AAAA,QAC5B,OAAO,EAAE;AAAA,QACT,aAAa,EAAE;AAAA,MACnB,EAAI;AAAA,IACJ,CAAC;AAED,UAAM,wBAAwB,eAAe;AAAA,MAC3C,KAAK;AAAA,MACL,MAAM;AAAA,MACN,WAAW,CAAC,WAAW;AACrB,YAAI,OAAO,SAAS;AAClB,eAAK,QAAQ,OAAO;AACpB,gBAAM,QAAQ;AAAA,QACpB,OAAW;AACL,gBAAM,QAAQ,OAAO,SAAS;AAAA,QACpC;AAAA,MACG;AAAA,MACD,SAAS,CAAC,QAAQ;AAChB,cAAM,QAAQ,oCAAoC,IAAI;AAAA,MAC1D;AAAA,IACA,CAAC;AAED,UAAM,8BAA8B,eAAe;AAAA,MACjD,KAAK;AAAA,MACL,MAAM;AAAA,MACN,WAAW,CAAC,WAAW;AACrB,YAAI,OAAO,SAAS;AAClB,sBAAY,QAAQ,OAAO;AAC3B,gBAAM,QAAQ;AAAA,QACpB,OAAW;AACL,gBAAM,QAAQ,OAAO,SAAS;AAAA,QACpC;AAAA,MACG;AAAA,MACD,SAAS,CAAC,QAAQ;AAChB,cAAM,QAAQ,kCAAkC,IAAI;AAAA,MACxD;AAAA,IACA,CAAC;AAGD,UAAM,WAAW,MAAY;AAC3B,UAAI,CAAC,QAAQ,YAAY,CAAC,QAAQ,aAAa,CAAC,QAAQ,SAAS;AAC/D,cAAM,QAAQ;AACd;AAAA,MACJ;AAEE,cAAQ,QAAQ;AAChB,YAAM,QAAQ;AAEd,UAAI;AACF,cAAM,eAAe,KAAK,UAAU,OAAO;AAE3C,YAAI,SAAS,UAAU,QAAQ;AAC7B,gBAAM,sBAAsB,MAAM,EAAE,SAAS,aAAc,CAAA;AAAA,QACjE,OAAW;AACL,gBAAM,4BAA4B,MAAM,EAAE,SAAS,aAAc,CAAA;AAAA,QACvE;AAAA,MACG,SAAQ,KAAK;AACZ,cAAM,QAAQ,0BAA0B,IAAI;AAAA,MAChD,UAAY;AACR,gBAAQ,QAAQ;AAAA,MACpB;AAAA,IACA;AAEA,UAAM,aAAa,CAAC,eAAe;AACjC,UAAI,CAAC,WAAY,QAAO;AACxB,YAAM,OAAO,IAAI,KAAK,UAAU;AAChC,aAAO,KAAK,mBAAkB;AAAA,IAChC;AAEA,UAAM,iBAAiB,CAAC,WAAW;AACjC,UAAI,WAAW,QAAQ,WAAW,OAAW,QAAO;AACpD,aAAO,IAAI,KAAK,aAAa,SAAS;AAAA,QACpC,OAAO;AAAA,QACP,UAAU;AAAA,MACd,CAAG,EAAE,OAAO,MAAM;AAAA,IAClB;AAEA,UAAM,iBAAiB,CAAC,WAAW;AACjC,YAAM,SAAS;AAAA,QACb,QAAQ;AAAA,QACR,UAAU;AAAA,QACV,WAAW;AAAA,QACX,SAAS;AAAA,QACT,aAAa;AAAA,MACjB;AACE,aAAO,OAAO,MAAM,KAAK;AAAA,IAC3B;AAGA,UAAM,iBAAiB,MAAM;AAC3B,sBAAgB,QAAQ;AACxB,cAAQ,WAAW;AACnB,uBAAiB,QAAQ,EAAE,UAAU,IAAI,eAAe,IAAI,eAAe,IAAI,YAAY,GAAE;AAC7F,4BAAsB,QAAQ;AAC9B,mBAAa,QAAQ;AACrB,mBAAa,QAAQ,CAAA;AAAA,IACvB;AAEA,UAAM,kBAAkB,CAAO,UAAU;;AACvC,YAAM,QAAO,0CAAO,WAAP,mBAAe,UAAf,mBAAuB;AACpC,UAAI,CAAC,KAAM;AACX,mBAAa,QAAQ;AACrB,qBAAe,QAAQ;AACvB,UAAI;AAEF,cAAM,MAAM,MAAM,IAAI,QAAQ,CAAC,SAAS,WAAW;AACjD,gBAAM,SAAS,IAAI,WAAU;AAC7B,iBAAO,SAAS,MAAM,QAAQ,OAAO,OAAO,MAAM,CAAC;AACnD,iBAAO,UAAU;AACjB,iBAAO,cAAc,IAAI;AAAA,QAC1B,CAAA;AACD,cAAM,MAAM,MAAM,MAAM,0EAA0E;AAAA,UAChG,QAAQ;AAAA,UACR,SAAS,EAAE,gBAAgB,mBAAoB;AAAA,UAC/C,MAAM,KAAK,UAAU,EAAE,YAAY,IAAK,CAAA;AAAA,QACzC,CAAA;AACD,cAAM,OAAO,MAAM,IAAI,KAAI;AAC3B,cAAM,OAAM,6BAAM,YAAW;AAC7B,YAAI,CAAC,IAAI,MAAM,EAAC,2BAAK,YAAW,EAAC,2BAAK,OAAM;AAC1C,gBAAM,IAAI,OAAM,2BAAK,UAAS,sBAAsB,IAAI,MAAM,GAAG;AAAA,QACvE;AAEI,cAAM,oBAAoB,IAAI,KAAK,iBAAiB;AACpD,cAAM,eAAe,IAAI,KAAK,gBAAgB;AAE9C,cAAM,WAAW,MAAM,gBAAgB,EAAE,mBAAmB,cAAc,GAAI,CAAA;AAC9E,YAAI,CAAC,UAAU;AACb,gBAAM,IAAI,MAAM,uDAAuD;AAAA,QAC7E;AACI,gBAAQ,WAAW,SAAS;AAC5B,yBAAiB,QAAQ;AAAA,UACvB,UAAU,SAAS;AAAA,UACnB,eAAe,SAAS,iBAAiB,gBAAgB,SAAS;AAAA,UAClE,eAAe;AAAA,UACf,YAAY,qBAAqB;AAAA,QACvC;AACI,wBAAgB,QAAQ;AAAA,MACzB,SAAQ,GAAG;AACV,qBAAa,QAAQ,EAAE,WAAW;AAAA,MACtC,UAAY;AACR,uBAAe,QAAQ;AAAA,MAC3B;AAAA,IACA;AAEA,aAAe,gBAAgB,IAAqC;AAAA,iDAArC,EAAE,mBAAmB,gBAAgB;AAElE,YAAI,cAAc;AAEhB,gBAAM,cAAc,CAAC,aAAa,eAAe;AACjD,qBAAW,SAAS,aAAa;AAC/B,gBAAI;AACF,oBAAM,SAAS,MAAM,oBAAoB,OAAO,YAAY;AAC5D,kBAAI,OAAQ,QAAO;AAAA,YACpB,SAAQ,GAAG;AAAA,YAElB;AAAA,UACA;AAAA,QACA;AAEE,YAAI,mBAAmB;AACrB,cAAI;AACF,kBAAM,SAAS,MAAM,MAAM,iCAAiC,mBAAmB,iBAAiB,CAAC,EAAE;AACnG,gBAAI,OAAO,IAAI;AACb,oBAAM,UAAU,MAAM,OAAO,KAAI;AACjC,oBAAM,MAAM,mCAAS;AACrB,kBAAI,2BAAK,UAAU;AACjB,uBAAO,EAAE,UAAU,IAAI,UAAU,eAAe,IAAI,iBAAiB,IAAI,SAAQ;AAAA,cAC3F;AAAA,YACA;AAAA,UACK,SAAQ,GAAG;AAAA,UAAA;AAAA,QAChB;AACE,eAAO;AAAA,MACT;AAAA;AAEA,aAAe,oBAAoB,OAAO,OAAO;AAAA;AAC/C,cAAM,SAAS,IAAI,gBAAe;AAClC,eAAO,IAAI,UAAU,KAAK,UAAU,CAAC,QAAQ,eAAe,CAAC,CAAC;AAC9D,eAAO,IAAI,WAAW,KAAK,UAAU,CAAC,CAAC,OAAO,KAAK,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC;AACnE,eAAO,IAAI,qBAAqB,GAAG;AACnC,cAAM,MAAM,MAAM,MAAM,0BAA0B,OAAO,SAAQ,CAAE,EAAE;AACrE,YAAI,CAAC,IAAI,GAAI,QAAO;AACpB,cAAM,OAAO,MAAM,IAAI,KAAI;AAC3B,cAAM,OAAO,6BAAM;AACnB,YAAI,MAAM,QAAQ,IAAI,KAAK,KAAK,SAAS,GAAG;AAC1C,iBAAO,EAAE,UAAU,KAAK,CAAC,EAAE,MAAM,eAAe,KAAK,CAAC,EAAE,iBAAiB,KAAK,CAAC,EAAE,KAAI;AAAA,QACzF;AACE,eAAO;AAAA,MACT;AAAA;AAGA,UAAM,sBAAsB,CAAO,UAAU;AAC3C,UAAI,CAAC,SAAS,MAAM,SAAS,GAAG;AAC9B,qBAAa,QAAQ,CAAA;AACrB;AAAA,MACJ;AAEE,0BAAoB,QAAQ;AAC5B,UAAI;AACF,cAAM,SAAS,IAAI,gBAAe;AAClC,eAAO,IAAI,UAAU,KAAK,UAAU,CAAC,QAAQ,iBAAiB,iBAAiB,WAAW,CAAC,CAAC;AAC5F,eAAO,IAAI,WAAW,KAAK,UAAU,CAAA,CAAE,CAAC;AACxC,eAAO,IAAI,cAAc,KAAK,UAAU;AAAA,UACtC,CAAC,iBAAiB,QAAQ,IAAI,KAAK,GAAG;AAAA,UACtC,CAAC,QAAQ,QAAQ,IAAI,KAAK,GAAG;AAAA,UAC7B,CAAC,iBAAiB,QAAQ,IAAI,KAAK,GAAG;AAAA,UACtC,CAAC,aAAa,QAAQ,IAAI,KAAK,GAAG;AAAA,QACxC,CAAK,CAAC;AACF,eAAO,IAAI,qBAAqB,IAAI;AAEpC,cAAM,MAAM,MAAM,MAAM,0BAA0B,OAAO,SAAQ,CAAE,EAAE;AACrE,YAAI,IAAI,IAAI;AACV,gBAAM,OAAO,MAAM,IAAI,KAAI;AAC3B,uBAAa,SAAQ,6BAAM,SAAQ,CAAA;AAAA,QACzC;AAAA,MACG,SAAQ,GAAG;AACV,gBAAQ,MAAM,8BAA8B,CAAC;AAC7C,qBAAa,QAAQ,CAAA;AAAA,MACzB,UAAY;AACR,4BAAoB,QAAQ;AAAA,MAChC;AAAA,IACA;AAGA,UAAM,qBAAqB,CAAO,WAAW;AAC3C,UAAI,CAAC,UAAU,CAAC,OAAO,MAAO;AAE9B,UAAI;AAEF,cAAM,MAAM,MAAM,MAAM,0BAA0B,mBAAmB,OAAO,KAAK,CAAC,EAAE;AACpF,YAAI,CAAC,IAAI,GAAI,OAAM,IAAI,MAAM,kCAAkC;AAE/D,cAAM,OAAO,MAAM,IAAI,KAAI;AAC3B,cAAM,WAAW,6BAAM;AAEvB,YAAI,UAAU;AACZ,kBAAQ,WAAW,SAAS;AAC5B,2BAAiB,QAAQ;AAAA,YACvB,UAAU,SAAS;AAAA,YACnB,eAAe,SAAS,iBAAiB,SAAS;AAAA,YAClD,eAAe,SAAS,iBAAiB,SAAS,aAAa;AAAA,YAC/D,YAAY;AAAA,UACpB;AACM,gCAAsB,QAAQ,SAAS,iBAAiB,SAAS;AACjE,0BAAgB,QAAQ;AAAA,QAC9B;AAAA,MACG,SAAQ,GAAG;AACV,cAAM,QAAQ,uCAAuC,EAAE,WAAW;AAAA,MACtE;AAAA,IACA;AAGA,UAAM,UAAU,MAAM;AACpB,UAAI,QAAQ,YAAY,QAAQ,aAAa,QAAQ,SAAS;AAC5D,iBAAQ;AAAA,MACZ;AAAA,IACA,CAAC;AAGD,cAAU,MAAM;AAEd,YAAM,QAAQ,oBAAI,KAAI;AACtB,YAAM,gBAAgB,IAAI,KAAK,MAAM,QAAO,IAAM,KAAK,KAAK,KAAK,KAAK,GAAK;AAE3E,cAAQ,UAAU,MAAM,YAAa,EAAC,MAAM,GAAG,EAAE,CAAC;AAClD,cAAQ,YAAY,cAAc,YAAa,EAAC,MAAM,GAAG,EAAE,CAAC;AAAA,IAC9D,CAAC;;;;;AAhtBC,aAAAA,UAAA,GAAAC,mBAiaM,OAjaN,YAiaM;AAAA,QA/ZJC,gBAiBM,OAjBN,YAiBM;AAAA,UAhBJA,gBAeM,OAfN,YAeM;AAAA,YAdJA,gBAaM,OAbN,YAaM;AAAA,cAZJA,gBAGM,OAAA,MAAA;AAAA,gBAFJ,OAAA,EAAA,MAAA,OAAA,EAAA,IAAAA,gBAAyE,MAArE,EAAA,OAAM,mCAAkC,GAAC,2BAAuB,EAAA;AAAA,gBACpEA,gBAAgE,KAAhE,YAAiC,6BAAWC,MAAO,OAAA,EAAC,IAAI,IAAG,KAAC,CAAA;AAAA;cAE9DD,gBAOM,OAPN,YAOM;AAAA,gBANNE,YAES,mBAAA;AAAA,kBAFA,SAAK,OAAA,CAAA,MAAA,OAAA,CAAA,IAAA,YAAEC,KAAO,QAAC,KAAI,EAAA,MAAA,UAAA,CAAA;AAAA,kBAAuB,OAAM;AAAA,kBAAO,SAAQ;AAAA;mCAAQ,MAEhF,OAAA,EAAA,MAAA,OAAA,EAAA,IAAA;AAAA,oCAFgF,gBAEhF;AAAA;;;;gBACAD,YAES,mBAAA;AAAA,kBAFA,SAAO,OAAA,CAAA,MAAA,OAAA,CAAA,IAAA,YAAAD,MAAA,OAAA,EAAQ,OAAO,OAAM;AAAA,kBAAI,OAAM;AAAA,kBAAO,SAAQ;AAAA;mCAAU,MAExE,OAAA,EAAA,MAAA,OAAA,EAAA,IAAA;AAAA,oCAFwE,UAExE;AAAA;;;;;;;;QAOND,gBA0YM,OA1YN,YA0YM;AAAA,UAxYJA,gBA4GM,OA5GN,YA4GM;AAAA,YA3GJ,OAAA,EAAA,MAAA,OAAA,EAAA,IAAAA,gBAAiE,MAA7D,EAAA,OAAM,2CAA0C,GAAC,WAAO,EAAA;AAAA,YAC5DA,gBA8FM,OA9FN,YA8FM;AAAA,cA7FJA,gBA0EM,OA1EN,aA0EM;AAAA,gBAzEJ,OAAA,EAAA,MAAA,OAAA,EAAA,IAAAA,gBAA4E,SAArE,EAAA,OAAM,+CAA8C,GAAC,YAAQ,EAAA;AAAA,gBACpEA,gBAuEM,OAvEN,aAuEM;AAAA,kBAtEO,gBAAe,SAA1BF,aAAAC,mBAUM,OAVN,aAUM;AAAA,oBATJC,gBAAyF,OAAzF,aAAkDI,gBAAA,iBAAA,MAAiB,aAAa,GAAA,CAAA;AAAA,oBAChFJ,gBAIM,OAJN,aAIM;AAAA,sBAHJA,gBAA8D,QAAxD,MAAA,WAASI,gBAAA,iBAAA,MAAiB,iBAAa,GAAA,GAAA,CAAA;AAAA,sBAC7C,OAAA,EAAA,MAAA,OAAA,EAAA,IAAAJ,gBAA2B,QAArB,EAAA,OAAM,OAAM,GAAC,KAAC,EAAA;AAAA,sBACpBA,gBAA8D,QAAxD,MAAA,cAAYI,gBAAA,iBAAA,MAAiB,cAAU,GAAA,GAAA,CAAA;AAAA;oBAE/CJ,gBAEM,OAAA,EAFD,OAAM,OAAM,GAAA;AAAA,sBACfA,gBAAiG,UAAA;AAAA,wBAAxF,SAAO;AAAA,wBAAgB,OAAM;AAAA,yBAAkC,kBAAgB;AAAA;sCAG5FD,mBA0DM,OAAA,aAAA;AAAA,oBAzDJC,gBA4BM,OA5BN,aA4BM;AAAA,sBA3BJA,gBAQS,UAAA;AAAA,wBAPN,+CAAO,WAAU,QAAA;AAAA,wBACjB,OAAKK,eAAA;AAAA;0BAA0I,WAAU,UAAA,SAAA,6CAAA;AAAA;yBAI3J,mBAED,CAAA;AAAA,sBACAL,gBAQS,UAAA;AAAA,wBAPN,+CAAO,WAAU,QAAA;AAAA,wBACjB,OAAKK,eAAA;AAAA;0BAA0I,WAAU,UAAA,OAAA,6CAAA;AAAA;yBAI3J,gBAED,CAAA;AAAA,sBACAL,gBAQS,UAAA;AAAA,wBAPN,+CAAO,WAAU,QAAA;AAAA,wBACjB,OAAKK,eAAA;AAAA;0BAA0I,WAAU,UAAA,UAAA,6CAAA;AAAA;yBAI3J,oBAED,CAAA;AAAA;oBAES,WAAU,UAAA,QAArBP,aAAAC,mBASM,OATN,aASM;AAAA,sBAROE,MAAW,WAAA,kBAAtBF,mBAIM,OAAA,aAAA;AAAA,wBAHJ,OAAA,EAAA,MAAA,OAAA,EAAA,IAAAC,gBAAyD,OAApD,EAAA,OAAM,OAAM,GAAC,qCAAiC,EAAA;AAAA,wBACnDA,gBAA+E,SAAA;AAAA,mCAApE;AAAA,0BAAJ,KAAI;AAAA,0BAAU,OAAM;AAAA,0BAAiB,UAAA;AAAA,0BAAS,aAAA;AAAA,0BAAY,OAAA;AAAA;wBACjE,OAAA,EAAA,MAAA,OAAA,EAAA,IAAAA,gBAAyD,OAApD,EAAA,OAAM,6BAA4B,GAAC,eAAW,EAAA;AAAA,6BAErDF,UAAA,GAAAC,mBAEM,oBAFM,0EAEZ;AAAA,0BAEc,WAAU,UAAA,WAA1BD,aAAAC,mBAIM,OAJN,aAIM;AAAA,sBAHJC,gBAAsF,SAAA;AAAA,wBAA/E,MAAK;AAAA,wBAAO,QAAO;AAAA,wBAAU,SAAQ;AAAA,wBAAe,UAAQ;AAAA;sBACxD,eAAc,sBAAzBD,mBAAuF,OAAvF,aAA8D,qBAAmB;sBACpE,aAAY,sBAAzBO,YAA8E,kBAAA;AAAA;wBAAnD,OAAM;AAAA,wBAAM,OAAM;AAAA;yCAAO,MAAkB;AAAA,0DAAf,aAAY,KAAA,GAAA,CAAA;AAAA;;;0BAErD,WAAU,UAAA,UAA1BR,aAAAC,mBAYM,OAZN,aAYM;AAAA,sBAXJG,YASED,MAAAM,WAAA,GAAA;AAAA,oCARS,sBAAqB;AAAA,qFAArB,sBAAqB,QAAA;AAAA,wBAC7B,SAAS,gBAAe;AAAA,wBACxB,SAAS,oBAAmB;AAAA,wBAC5B,UAAU;AAAA,wBACX,aAAY;AAAA,wBACX,kBAAc;AAAA,wBACd,UAAQ;AAAA,wBACR,WAAW;AAAA;sBAEJ,CAAA,QAAQ,yBAAlBR,mBAAwG,KAAxG,aAA+D,uCAAqC;;;;;cAK5GC,gBAQM,OAAA,MAAA;AAAA,gBAPJ,OAAA,EAAA,MAAA,OAAA,EAAA,IAAAA,gBAA6E,SAAtE,EAAA,OAAM,+CAA8C,GAAC,aAAS,EAAA;AAAA,+BACrEA,gBAKE,SAAA;AAAA,kBAJA,MAAK;AAAA,kBACI,uBAAA,OAAA,CAAA,MAAA,OAAA,CAAA,IAAA,YAAA,QAAQ,YAAS;AAAA,kBAC1B,OAAM;AAAA,kBACN,UAAA;AAAA;kBAFS,CAAAQ,YAAA,QAAQ,SAAS;AAAA;;cAK9BR,gBAQM,OAAA,MAAA;AAAA,gBAPJ,OAAA,EAAA,MAAA,OAAA,EAAA,IAAAA,gBAA2E,SAApE,EAAA,OAAM,+CAA8C,GAAC,WAAO,EAAA;AAAA,+BACnEA,gBAKE,SAAA;AAAA,kBAJA,MAAK;AAAA,kBACI,uBAAA,OAAA,CAAA,MAAA,OAAA,CAAA,IAAA,YAAA,QAAQ,UAAO;AAAA,kBACxB,OAAM;AAAA,kBACN,UAAA;AAAA;kBAFS,CAAAQ,YAAA,QAAQ,OAAO;AAAA;;;YAM9BR,gBAUM,OAVN,aAUM;AAAA,cATJE,YAQS,mBAAA;AAAA,gBAPN,SAAO;AAAA,gBACP,SAAS,QAAO;AAAA,gBACjB,OAAM;AAAA,gBACN,SAAQ;AAAA,gBACP,UAAQ,CAAG,QAAQ,YAAQ,CAAK,QAAQ,aAAS,CAAK,QAAQ;AAAA;iCAChE,MAED,OAAA,EAAA,MAAA,OAAA,EAAA,IAAA;AAAA,kCAFC,aAED;AAAA;;;;;;UAKJF,gBA4BM,OA5BN,aA4BM;AAAA,YA3BJA,gBA0BM,OA1BN,aA0BM;AAAA,cAzBJ,OAAA,EAAA,MAAA,OAAA,EAAA,IAAAA,gBAAiE,MAA7D,EAAA,OAAM,sCAAqC,GAAC,gBAAY,EAAA;AAAA,cAC5DA,gBAuBM,OAvBN,aAuBM;AAAA,gBAtBJA,gBAUS,UAAA;AAAA,kBATN,+CAAO,SAAQ,QAAA;AAAA,kBACf,OAAKK,eAAA;AAAA;oBAAkG,SAAQ,UAAA;;mBAMjH,oBAED,CAAA;AAAA,gBACAL,gBAUS,UAAA;AAAA,kBATN,+CAAO,SAAQ,QAAA;AAAA,kBACf,OAAKK,eAAA;AAAA;oBAAkG,SAAQ,UAAA;;mBAMjH,kBAED,CAAA;AAAA;;;UAMK,QAAO,SAAlBP,UAAA,GAAAC,mBAGM,OAHN,aAGM,OAAA,EAAA,MAAA,OAAA,EAAA,IAAA;AAAA,YAFJC,gBAAgF,OAAA,EAA3E,OAAM,+DAA8D,GAAA,MAAA,EAAA;AAAA,YACzEA,gBAAuD,QAAjD,EAAA,OAAM,wBAAqB,mBAAe,EAAA;AAAA;UAIrC,MAAK,sBAAlBM,YAEQ,kBAAA;AAAA;YAFY,OAAM;AAAA,YAAM,OAAM;AAAA;6BACpC,MAAW;AAAA,8CAAR,MAAK,KAAA,GAAA,CAAA;AAAA;;;UAIC,SAAA,UAAwB,UAAA,CAAA,QAAA,SAAW,KAAA,MAAK,SAAM,KAAzDR,aAAAC,mBAiHM,OAjHN,aAiHM;AAAA,YAhHJC,gBAwDM,OAxDN,aAwDM;AAAA,cAvDJA,gBAIM,OAJN,aAIM;AAAA,gBAHJA,gBAEK,MAFL,aAAgD,sCAC3B,KAAI,MAAC,MAAM,IAAG,eACnC,CAAA;AAAA;cAEFA,gBAiDM,OAjDN,aAiDM;AAAA,gBAhDJA,gBA+CQ,SA/CR,aA+CQ;AAAA,8CA9CNA,gBAqBQ,SAAA,EArBD,OAAM,gBAAY;AAAA,oBACvBA,gBAmBK,MAAA,MAAA;AAAA,sBAlBHA,gBAEK,MAFD,EAAA,OAAM,iFAAgF,GAAC,WAE3F;AAAA,sBACAA,gBAEK,MAFD,EAAA,OAAM,iFAAgF,GAAC,QAE3F;AAAA,sBACAA,gBAEK,MAFD,EAAA,OAAM,iFAAgF,GAAC,YAE3F;AAAA,sBACAA,gBAEK,MAFD,EAAA,OAAM,iFAAgF,GAAC,UAE3F;AAAA,sBACAA,gBAEK,MAFD,EAAA,OAAM,kFAAiF,GAAC,gBAE5F;AAAA,sBACAA,gBAEK,MAFD,EAAA,OAAM,qFAAkF,eAE5F;AAAA;;kBAGJA,gBAuBQ,SAvBR,aAuBQ;AAAA,sCAtBND,mBAqBKU,UAAA,MAAAC,WArBiB,KAAI,OAAA,CAAf,YAAO;0CAAlBX,mBAqBK,MAAA;AAAA,wBArBwB,KAAK,QAAQ;AAAA,wBAAM,OAAM;AAAA;wBACpDC,gBAEK,MAFL,aACKI,gBAAA,QAAQ,IAAI,GAAA,CAAA;AAAA,wBAEjBJ,gBAEK,MAFL,aAEKI,gBADA,WAAW,QAAQ,YAAY,CAAA,GAAA,CAAA;AAAA,wBAEpCJ,gBAEK,MAFL,aACKI,gBAAA,QAAQ,aAAa,GAAA,CAAA;AAAA,wBAE1BJ,gBAIK,MAJL,aAIK;AAAA,0BAHHE,YAEQ,kBAAA;AAAA,4BAFA,OAAO,eAAe,QAAQ,MAAM;AAAA;6CAC1C,MAAoB;AAAA,8BAAjBS,gBAAAP,gBAAA,QAAQ,MAAM,GAAA,CAAA;AAAA;;;;wBAGrBJ,gBAEK,MAFL,aAEKI,gBADA,eAAe,QAAQ,WAAW,CAAA,GAAA,CAAA;AAAA,wBAEvCJ,gBAEK,MAFL,aAEKI,gBADA,eAAe,QAAQ,kBAAkB,CAAA,GAAA,CAAA;AAAA;;;;;;8BASxDL,mBAoDMU,UAAA,MAAAC,WApDiB,KAAI,OAAA,CAAf,YAAO;kCAAnBX,mBAoDM,OAAA;AAAA,gBApDwB,KAAG,WAAa,QAAQ,IAAI;AAAA,gBAAI,OAAM;AAAA;gBAClEC,gBAQM,OARN,aAQM;AAAA,kBAPJA,gBAEK,MAFL,aAAgD,eAClCI,gBAAA,QAAQ,IAAI,IAAG,QAAMA,gBAAA,QAAQ,aAAa,GAAA,CAAA;AAAA,kBAExDJ,gBAGI,KAHJ,aAAiC,YACzBI,gBAAG,WAAW,QAAQ,YAAY,KAAI,eACrCA,gBAAG,eAAe,QAAQ,WAAW,CAAA,GAAA,CAAA;AAAA;gBAGhDJ,gBAyCM,OAzCN,aAyCM;AAAA,kBAxCJA,gBAuCQ,SAvCR,aAuCQ;AAAA,gDAtCNA,gBAkBQ,SAAA,EAlBD,OAAM,gBAAY;AAAA,sBACvBA,gBAgBK,MAAA,MAAA;AAAA,wBAfHA,gBAEK,MAFD,EAAA,OAAM,iFAAgF,GAAC,QAE3F;AAAA,wBACAA,gBAEK,MAFD,EAAA,OAAM,iFAAgF,GAAC,eAE3F;AAAA,wBACAA,gBAEK,MAFD,EAAA,OAAM,kFAAiF,GAAC,OAE5F;AAAA,wBACAA,gBAEK,MAFD,EAAA,OAAM,kFAAiF,GAAC,QAE5F;AAAA,wBACAA,gBAEK,MAFD,EAAA,OAAM,qFAAkF,UAE5F;AAAA;;oBAGJA,gBAkBQ,SAlBR,aAkBQ;AAAA,uBAjBNF,UAAA,IAAA,GAAAC,mBAgBKU,UAhBc,MAAAC,WAAA,QAAQ,QAAhB,SAAI;4CAAfX,mBAgBK,MAAA;AAAA,0BAhB8B,KAAK,KAAK;AAAA,0BAAW,OAAM;AAAA;0BAC5DC,gBAEK,MAFL,aACKI,gBAAA,KAAK,SAAS,GAAA,CAAA;AAAA,0BAEnBJ,gBAEK,MAFL,aACKI,gBAAA,KAAK,SAAS,GAAA,CAAA;AAAA,0BAEnBJ,gBAEK,MAFL,aAEKI,gBADA,KAAK,GAAG,IAAG,MAACA,gBAAG,KAAK,GAAG,GAAA,CAAA;AAAA,0BAE5BJ,gBAEK,MAFL,aAEKI,gBADA,eAAe,KAAK,IAAI,CAAA,GAAA,CAAA;AAAA,0BAE7BJ,gBAEK,MAFL,aAEKI,gBADA,eAAe,KAAK,MAAM,CAAA,GAAA,CAAA;AAAA;;;;;;;;UAUhC,SAAA,UAA2B,aAAA,CAAA,QAAA,SAAW,YAAA,MAAY,SAAM,KAAnEN,aAAAC,mBA+GM,OA/GN,aA+GM;AAAA,YA9GJC,gBAsDM,OAtDN,aAsDM;AAAA,cArDJA,gBAIM,OAJN,aAIM;AAAA,gBAHJA,gBAEK,MAFL,aAAgD,kDACf,YAAW,MAAC,MAAM,IAAG,aACtD,CAAA;AAAA;cAEFA,gBA+CM,OA/CN,aA+CM;AAAA,gBA9CJA,gBA6CQ,SA7CR,aA6CQ;AAAA,8CA5CNA,gBAqBQ,SAAA,EArBD,OAAM,gBAAY;AAAA,oBACvBA,gBAmBK,MAAA,MAAA;AAAA,sBAlBHA,gBAEK,MAFD,EAAA,OAAM,iFAAgF,GAAC,YAE3F;AAAA,sBACAA,gBAEK,MAFD,EAAA,OAAM,iFAAgF,GAAC,QAE3F;AAAA,sBACAA,gBAEK,MAFD,EAAA,OAAM,mFAAkF,GAAC,YAE7F;AAAA,sBACAA,gBAEK,MAFD,EAAA,OAAM,kFAAiF,GAAC,gBAE5F;AAAA,sBACAA,gBAEK,MAFD,EAAA,OAAM,kFAAiF,GAAC,aAE5F;AAAA,sBACAA,gBAEK,MAFD,EAAA,OAAM,qFAAkF,eAE5F;AAAA;;kBAGJA,gBAqBQ,SArBR,aAqBQ;AAAA,sCApBND,mBAmBKU,UAAA,MAAAC,WAnBe,YAAW,OAAA,CAApB,UAAK;0CAAhBX,mBAmBK,MAAA;AAAA,wBAnB6B,QAAQ,MAAM,QAAQ,IAAI,MAAM,YAAY;AAAA,wBAAI,OAAM;AAAA;wBACtFC,gBAEK,MAFL,aACKI,gBAAA,MAAM,aAAa,GAAA,CAAA;AAAA,wBAExBJ,gBAEK,MAFL,aAEKI,gBADA,WAAW,MAAM,YAAY,CAAA,GAAA,CAAA;AAAA,wBAElCJ,gBAEK,MAFL,aACKI,gBAAA,MAAM,aAAa,GAAA,CAAA;AAAA,wBAExBJ,gBAEK,MAFL,aAEKI,gBADA,eAAe,MAAM,YAAY,CAAA,GAAA,CAAA;AAAA,wBAEtCJ,gBAEK,MAFL,aAEKI,gBADA,eAAe,MAAM,SAAS,CAAA,GAAA,CAAA;AAAA,wBAEnCJ,gBAEK,MAFL,aAEKI,gBADA,eAAe,MAAM,kBAAkB,CAAA,GAAA,CAAA;AAAA;;;;;;8BAStDL,mBAoDMU,UAAA,MAAAC,WApDe,YAAW,OAAA,CAApB,UAAK;kCAAjBX,mBAoDM,OAAA;AAAA,gBApD6B,gBAAgB,MAAM,QAAQ,IAAI,MAAM,YAAY;AAAA,gBAAI,OAAM;AAAA;gBAC/FC,gBAQM,OARN,aAQM;AAAA,kBAPJA,gBAEK,MAFL,aACKI,gBAAA,MAAM,aAAa,IAAG,QAAMA,gBAAA,WAAW,MAAM,YAAY,CAAA,GAAA,CAAA;AAAA,kBAE9DJ,gBAGI,KAHJ,aACKI,gBAAA,MAAM,aAAa,IAAG,wBACfA,gBAAA,eAAe,MAAM,YAAY,CAAA,GAAA,CAAA;AAAA;gBAG/CJ,gBAyCM,OAzCN,aAyCM;AAAA,kBAxCJA,gBAuCQ,SAvCR,aAuCQ;AAAA,gDAtCNA,gBAkBQ,SAAA,EAlBD,OAAM,gBAAY;AAAA,sBACvBA,gBAgBK,MAAA,MAAA;AAAA,wBAfHA,gBAEK,MAFD,EAAA,OAAM,iFAAgF,GAAC,QAE3F;AAAA,wBACAA,gBAEK,MAFD,EAAA,OAAM,iFAAgF,GAAC,eAE3F;AAAA,wBACAA,gBAEK,MAFD,EAAA,OAAM,kFAAiF,GAAC,aAE5F;AAAA,wBACAA,gBAEK,MAFD,EAAA,OAAM,kFAAiF,GAAC,YAE5F;AAAA,wBACAA,gBAEK,MAFD,EAAA,OAAM,qFAAkF,gBAE5F;AAAA;;oBAGJA,gBAkBQ,SAlBR,aAkBQ;AAAA,uBAjBNF,UAAA,IAAA,GAAAC,mBAgBKU,UAhBc,MAAAC,WAAA,MAAM,QAAd,SAAI;4CAAfX,mBAgBK,MAAA;AAAA,0BAhB4B,KAAK,KAAK;AAAA,0BAAW,OAAM;AAAA;0BAC1DC,gBAEK,MAFL,aACKI,gBAAA,KAAK,SAAS,GAAA,CAAA;AAAA,0BAEnBJ,gBAEK,MAFL,aACKI,gBAAA,KAAK,SAAS,GAAA,CAAA;AAAA,0BAEnBJ,gBAEK,MAFL,aAEKI,gBADA,KAAK,SAAS,IAAG,MAACA,gBAAG,KAAK,GAAG,GAAA,CAAA;AAAA,0BAElCJ,gBAEK,MAFL,aAEKI,gBADA,eAAe,KAAK,QAAQ,CAAA,GAAA,CAAA;AAAA,0BAEjCJ,gBAEK,MAFL,aAEKI,gBADA,eAAe,KAAK,YAAY,CAAA,GAAA,CAAA;AAAA;;;;;;;;UAUrC,CAAA,QAAA,SAAW,KAAI,MAAC,WAAgB,KAAA,YAAA,MAAY,WAAM,KAA9DN,UAAA,GAAAC,mBAQM,OARN,aAQM,OAAA,EAAA,MAAA,OAAA,EAAA,IAAA;AAAA;;;;;;;;"}